#!/usr/bin/env bash

# run this script to rebuild image for release branch

repo_list=(
grafana-dashboard-loader
endpoint-metrics-operator
prometheus-alertmanager
prometheus
node-exporter
metrics-collector
observatorium-operator
thanos
rbac-query-proxy
kube-rbac-proxy
kube-state-metrics
observatorium
management-ingress
)

main_repo=(
multicluster-observability-operator
observatorium-operator
observatorium
management-ingress
)


for repo_name in ${repo_list[@]}
do
  if [[ "${main_repo[@]}"  =~ $repo_name ]];then
    base_branch=main
  else
    base_branch=release-2.4
  fi
  git clone git@github.com:open-cluster-management/$repo_name.git
  cd $repo_name || exit
  git checkout $base_branch
  git commit --allow-empty --signoff -m "rebuild img"
  git push -f
  cd .. && rm -rf $repo_name
done
